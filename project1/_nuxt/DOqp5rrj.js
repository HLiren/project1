import{_ as W}from"./CZNVgcsM.js";import{_ as q}from"./Bd25rckc.js";import{_ as R}from"./DdbR_RyX.js";import{_ as Y}from"./BlN-oVz0.js";import{_ as F}from"./CihD9TyV.js";import{_ as z}from"./BgbRjMRV.js";import{_ as G}from"./QQpZUDes.js";import{_ as J}from"./DpEiREkT.js";import{_ as X}from"./Da-FnTWc.js";import{_ as Z}from"./CCM_uDDJ.js";import{P as ee}from"./g7M5w5Vz.js";import{e as te,i as oe,a as le}from"./BkImKAAo.js";import{e as se,r as c,h as ae,i as A,o as U,w as t,b as s,a as i,t as f,u as a,d,l as ne,c as re,f as ie,s as S}from"./BqYyig0m.js";import{u as ue}from"./C8JUD4uS.js";import{f as ce}from"./DkQxb8LZ.js";import"./NJN48tce.js";const de={class:"preview-block"},me={class:"flex lg:flex-row flex-col lg:justify-between justify-center items-center mb-5"},pe={class:"flex lg:flex-row flex-col items-center lg:gap-2 lg:mb-0 mb-2"},fe={class:"flex lg:flex-row flex-col lg:gap-4 gap-y-2"},_e={class:"flex gap-1"},He=se({__name:"warehouse-items",setup(ve){ue({title:"Warehouse Items"});const I=c(null),x=c(0),h=c(""),k=c([]),b=c([]),g=c(!1),H=c([{key:"sku",label:"SKU"},{key:"title",label:"Item Title"},{key:"warehouseStatus",label:"Warehouse Status"},{key:"availableQty",label:"Available Qty"},{key:"itemDetail",label:"Action"}]),$=async()=>{const{data:l}=await te();b.value=l==null?void 0:l.stock},V=()=>{g.value=!g.value,b.value=b.value.map(l=>({...l,selected:g.value&&!l.disabled})),k.value=g.value?b.value.filter(l=>!l.disabled):[]},Q=l=>{k.value=l},L=async l=>{try{const e=l.target;if(!e||!e.files)throw new Error("File input is missing or invalid.");const r=e.files.item(0);if(!r)return;const u=await(n=>new Promise((_,p)=>{ee.parse(n,{encoding:"ISO-8859-1",download:!0,header:!0,skipEmptyLines:!0,complete:y=>{if(y.errors.length>0)p(y.errors);else{const w=y.data.map(D=>Object.fromEntries(Object.entries(D).map(([B,o])=>[B.trim(),typeof o=="string"?o.trim():o])));_(w)}},error:y=>p(y)})}))(r);await M(u)}catch(e){S({title:"Error !",content:e},"danger")}finally{x.value++}},E=()=>{I.value&&I.value.click()},M=async l=>{try{const{data:e}=await oe({items:l});(e==null?void 0:e.errors.length)>0&&S({title:"Warning !",content:e==null?void 0:e.errors},"warning"),e!=null&&e.message&&S({title:"Success !",content:e==null?void 0:e.message},"success")}catch(e){S({title:"Error !",content:e},"danger")}finally{K(),$(),x.value++}},T=l=>l>0?"success":l===0?"danger":"light",C=c(!1),m=c({detail:{sku:"",title:"",availableQty:0},uk:[],hk:[]}),N=c([{label:"Status",key:"status"},{label:"Item Type",key:"itemType"},{label:"QTY",key:"qty"}]),O=c([{label:"Item ID",key:"itemId"},{label:"Item Type",key:"itemType"},{label:"Hold By Order",key:"holdByOrder"},{label:"Created Date",key:"createdAt"}]),j=async l=>{var _;const{sku:e,title:r,availableQty:v,warehouseStatus:u}=l;m.value.detail={sku:e,title:r,availableQty:v};const{data:n}=await le({sku:l.sku,assignedTo:"pending"});m.value.hk.push({status:"In stock",itemType:"Direct Line Item",qty:u.HK,date:""}),m.value.uk=(_=n==null?void 0:n.info)==null?void 0:_.items,m.value.uk.reverse()},P=()=>{const l=`SKU,Item Title,UK,HK,Available Qty
`,e=k.value.map(p=>`${p.sku},${p.title},${p.warehouseStatus.UK},${p.warehouseStatus.HK},${p.availableQty}`).join(`
`),r=l+e,v=new Blob([r],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a"),n=URL.createObjectURL(v);u.href=n;const _=ce(new Date,"YYYYMMDD");u.setAttribute("download",`warehouse_items_${_}.csv`),document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(n)},K=()=>{C.value=!1,m.value={detail:{sku:"",title:"",availableQty:0},uk:[],hk:[]}};return ae(()=>{$()}),(l,e)=>{const r=W,v=q,u=R,n=Y,_=F,p=z,y=G,w=J,D=X,B=Z;return U(),A(B,null,{default:t(()=>[s(_,{title:"SKU Details","backdrop-close":!1,size:"full",visible:a(C),onClose:e[1]||(e[1]=o=>K())},{footer:t(()=>[s(n,{variant:"outline",color:"info",onClick:e[0]||(e[0]=o=>K())},{default:t(()=>e[11]||(e[11]=[d(" Close ")])),_:1})]),default:t(()=>[i("div",de,[e[7]||(e[7]=i("div",null,"SKU",-1)),i("div",null,f(a(m).detail.sku),1),e[8]||(e[8]=i("div",null,"Item title",-1)),i("div",null,f(a(m).detail.title),1),e[9]||(e[9]=i("div",null,"Available Qty",-1)),i("div",null,f(a(m).detail.availableQty),1)]),s(u,{tabs:[{name:"uk",label:"UK"},{name:"hk",label:"HK"}]},{uk:t(()=>[s(v,{items:a(m).uk,headers:a(O)},{itemType:t(()=>[s(r,{color:"secondary"},{default:t(()=>e[10]||(e[10]=[d(" Local Item ")])),_:1})]),_:1},8,["items","headers"])]),hk:t(()=>[s(v,{items:a(m).hk,headers:a(N)},{status:t(({item:o})=>[s(r,{color:Number(o.qty)>0?"success":"dark"},{default:t(()=>[d(f(o.status),1)]),_:2},1032,["color"])]),itemType:t(({item:o})=>[s(r,{color:"primary"},{default:t(()=>[d(f(o.itemType),1)]),_:2},1024)]),_:1},8,["items","headers"])]),_:1})]),_:1},8,["visible"]),i("div",me,[i("div",pe,[s(p,{modelValue:a(h),"onUpdate:modelValue":e[2]||(e[2]=o=>ne(h)?h.value=o:null),placeholder:"Search","icon-left":"icon-zoom"},null,8,["modelValue"])]),i("div",fe,[s(n,{color:"info",disabled:a(b).length==0,onClick:e[3]||(e[3]=o=>V())},{default:t(()=>[d(f(a(g)?"Deselect All":"Select All"),1)]),_:1},8,["disabled"]),s(y,{class:"hidden lg:block"}),s(n,{color:"primary",variant:"outline",disabled:!a(k).length,class:"relative",onClick:e[4]||(e[4]=o=>P())},{icon:t(()=>[s(w,{class:"icon-download"})]),default:t(()=>[e[12]||(e[12]=d(" Download CSV ")),a(k).length?(U(),A(r,{key:0,color:"secondary",rounded:"",position:"top-right"},{default:t(()=>[d(f(a(k).length),1)]),_:1})):ie("",!0)]),_:1},8,["disabled"]),(U(),re("input",{type:"file",accept:".csv",ref_key:"fileInput",ref:I,onChange:e[5]||(e[5]=o=>L(o)),key:a(x),hidden:""},null,32)),s(n,{size:"md",onClick:e[6]||(e[6]=o=>E())},{icon:t(()=>[s(w,{class:"icon-cloud-upload"})]),default:t(()=>[e[13]||(e[13]=d(" Create HK Items (CSV) "))]),_:1})])]),s(D,{items:a(b),"search-query":a(h),headers:a(H),selectable:"",onSelectItems:Q},{header:t(()=>e[14]||(e[14]=[i("div",{class:"text-gray-950 text-base font-medium"}," Browse Warehouse Items ",-1)])),warehouseStatus:t(({item:o})=>[i("div",_e,[s(r,{color:T(o.warehouseStatus.UK)},{default:t(()=>[d(" UK:"+f(o.warehouseStatus.UK),1)]),_:2},1032,["color"]),s(r,{color:T(o.warehouseStatus.HK)},{default:t(()=>[d(" HK:"+f(o.warehouseStatus.HK),1)]),_:2},1032,["color"])])]),itemDetail:t(({item:o})=>[s(n,{color:"info",variant:"outline",onClick:ye=>(C.value=!0,j(o))},{icon:t(()=>[s(w,{class:"icon-edit"})]),default:t(()=>[e[15]||(e[15]=d(" Detail "))]),_:2},1032,["onClick"])]),_:1},8,["items","search-query","headers"])]),_:1})}}});export{He as default};
