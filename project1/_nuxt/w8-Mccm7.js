import{_ as G}from"./BgbRjMRV.js";import{_ as z}from"./DpEiREkT.js";import{e as F,r as i,j as J,C as K,c as C,o as x,a as u,f as j,t as h,H as Q,F as O,g as R,u as o,P as W,l as H,b as n,d as m,_ as Y,B as D,h as Z,i as ee,w as r,s as S}from"./BqYyig0m.js";import{_ as te}from"./BlN-oVz0.js";import{_ as se}from"./CihD9TyV.js";import{_ as oe}from"./Da-FnTWc.js";import{_ as le}from"./CCM_uDDJ.js";import{r as ne}from"./CadPLI2v.js";import{u as ae}from"./C8JUD4uS.js";import"./NJN48tce.js";const re={class:"flex flex-col space-y-1"},ie={class:"text-gray-700 font-semibold"},ue={class:"flex justify-center items-center border border-gray-300 rounded-xl px-2 py-1 min-h-[38px]"},de={class:"flex flex-wrap gap-2"},ce=["onClick"],me=["placeholder"],pe={key:0,class:"border rounded-xl mt-1 max-h-40 overflow-y-auto bg-white shadow-lg z-10"},fe=["onClick"],ve=F({__name:"MultiSelect",props:{modelValue:{},label:{},placeholder:{},options:{}},emits:["update:modelValue"],setup(p,{emit:k}){const f=p,$=k,v=i(""),y=i(!1),g=s=>{y.value=s},B=s=>{f.modelValue.includes(s)||$("update:modelValue",[...f.modelValue,s]),v.value="",y.value=!1},E=s=>{const a=[...f.modelValue];a.splice(s,1),$("update:modelValue",a)},I=()=>{$("update:modelValue",[])},b=J(()=>f.options.filter(s=>s.title.toLowerCase().includes(v.value.toLowerCase())&&!f.modelValue.includes(s.value))),L=s=>{const a=f.options.find(w=>w.value===s);return a?a.title:""};return K(v,s=>{y.value=s!==""}),(s,a)=>{const w=z;return x(),C("div",re,[u("label",ie,h(s.label),1),u("div",ue,[u("div",de,[(x(!0),C(O,null,R(s.modelValue,(d,_)=>(x(),C("span",{key:_,class:"flex justify-center items-center bg-gray-200 text-gray-800 px-2 py-1 rounded-xl text-sm"},[m(h(L(d))+" ",1),u("button",{type:"button",class:"ml-2 text-gray-500 hover:text-gray-700",onClick:M=>E(_)},[n(w,{class:"icon-X"})],8,ce)]))),128))]),o(y)?Q((x(),C("input",{key:0,"onUpdate:modelValue":a[0]||(a[0]=d=>H(v)?v.value=d:null),class:"grow focus:outline-hidden",placeholder:s.placeholder,onFocus:a[1]||(a[1]=d=>g(!0)),onBlur:a[2]||(a[2]=d=>g(!1))},null,40,me)),[[W,o(v)]]):j("",!0),u("button",{type:"button",class:"ml-auto text-gray-500 hover:text-gray-700",onClick:I},[n(w,{class:"icon-X text-lg"})]),u("button",{type:"button",class:"text-gray-500 hover:text-gray-700 ml-2",onClick:a[3]||(a[3]=d=>g(!o(y)))},[n(w,{class:"icon-arrows-directions-down text-lg"})])]),o(y)&&o(b).length>0?(x(),C("div",pe,[(x(!0),C(O,null,R(o(b),(d,_)=>(x(),C("div",{key:_,class:"px-4 py-2 hover:bg-gray-100 cursor-pointer",onClick:M=>B(d.value)},h(d.title),9,fe))),128))])):j("",!0)])}}}),ye=Y(ve,[["__scopeId","data-v-46bf51da"]]);async function ge(){return await D.get("/users/users")}async function _e(p){return await D.post("/users/users",p)}async function xe(p){return await D.delete("/users/users",p)}async function be(p){return await D.put("/users/users",p)}const we={class:"flex flex-col gap-4"},Ve={class:"flex gap-2"},Ce={class:"flex gap-2"},ke={class:"flex lg:flex-row flex-col lg:justify-between justify-center items-center mb-5"},$e={class:"flex gap-2"},Pe=F({__name:"users",setup(p){ae({title:"Users"});const k=i(""),f=i([]),$=i([]),v=i([{key:"name",label:"Name",sort:!0},{key:"email",label:"Email",sort:!0},{key:"roleList",label:"Roles",sort:!0},{key:"edit",label:"Action"}]),y=e=>{f.value=e},g=async()=>{const{data:e}=await ge();e!=null&&e.list.length&&($.value=e==null?void 0:e.list)},B=i([]),E=async()=>{const{data:e}=await ne();e!=null&&e.list.length&&(B.value=e==null?void 0:e.list.map(t=>({title:t.title,value:t.id})))},I=i(!1),b=i(!1),L=i(!1),s=i({id:0,name:"",email:"",password:"",roleId:[]}),a=async()=>{try{const{data:e}=await _e(s.value);e!=null&&e.message&&S({title:"Success !",content:e==null?void 0:e.message},"success")}catch(e){S({title:"Error !",content:e},"danger")}finally{g(),V()}},w=async e=>{b.value=!1,E(),e.roleList.length&&(s.value.roleId=e.roleList.map(c=>c.roleId));const{id:t,name:U,email:N}=e;s.value.id=typeof t=="number"?t:parseInt(t||"0",10),s.value.name=U,s.value.email=N},d=async()=>{try{const{data:e}=await be(s.value);e!=null&&e.message&&S({title:"Success !",content:e==null?void 0:e.message},"success")}catch(e){S({title:"Error !",content:e},"danger")}finally{g(),V()}},_=i(""),M=async()=>{try{const{data:e}=await xe({id:_.value});e!=null&&e.message&&S({title:"Success !",content:e==null?void 0:e.message},"success")}catch(e){S({title:"Error !",content:e},"danger")}finally{g(),V()}},V=()=>{L.value=!1,I.value=!1,_.value="",s.value={id:0,name:"",email:"",password:"",roleId:[]}};return Z(()=>{g()}),(e,t)=>{const U=G,N=ye,c=te,T=se,A=z,q=oe,X=le;return x(),ee(X,null,{default:r(()=>[n(T,{size:"lg",title:o(b)?"Create User":"Edit User","backdrop-close":!1,visible:o(I),onClose:t[5]||(t[5]=l=>V()),onSubmit:t[6]||(t[6]=l=>o(b)?a():d())},{footer:r(()=>[u("div",Ve,[n(c,{variant:"outline",color:"info",onClick:t[4]||(t[4]=l=>V())},{default:r(()=>t[12]||(t[12]=[m(" Close ")])),_:1}),n(c,{color:"primary",type:"submit"},{default:r(()=>t[13]||(t[13]=[m("Save Changes")])),_:1})])]),default:r(()=>[u("div",we,[n(U,{modelValue:o(s).name,"onUpdate:modelValue":t[0]||(t[0]=l=>o(s).name=l),label:"Name",placeholder:"Name"},null,8,["modelValue"]),n(U,{modelValue:o(s).email,"onUpdate:modelValue":t[1]||(t[1]=l=>o(s).email=l),label:"Email",placeholder:"Email"},null,8,["modelValue"]),n(U,{modelValue:o(s).password,"onUpdate:modelValue":t[2]||(t[2]=l=>o(s).password=l),label:"Password",type:"password",placeholder:"Password"},null,8,["modelValue"]),n(N,{modelValue:o(s).roleId,"onUpdate:modelValue":t[3]||(t[3]=l=>o(s).roleId=l),label:"Roles",placeholder:"Select a role",options:o(B)},null,8,["modelValue","options"])])]),_:1},8,["title","visible"]),n(T,{title:"Delete User","backdrop-close":!1,visible:o(L),onClose:t[8]||(t[8]=l=>V()),onSubmit:t[9]||(t[9]=l=>M())},{footer:r(()=>[u("div",Ce,[n(c,{variant:"outline",color:"info",onClick:t[7]||(t[7]=l=>V())},{default:r(()=>t[14]||(t[14]=[m(" Cancel ")])),_:1}),n(c,{color:"danger",type:"submit"},{default:r(()=>t[15]||(t[15]=[m("Delete")])),_:1})])]),default:r(()=>[t[16]||(t[16]=m(" Are you sure you want to delete this user? "))]),_:1},8,["visible"]),u("div",ke,[n(U,{modelValue:o(k),"onUpdate:modelValue":t[10]||(t[10]=l=>H(k)?k.value=l:null),placeholder:"Search","icon-left":"icon-zoom"},null,8,["modelValue"]),n(c,{color:"primary",class:"relative",onClick:t[11]||(t[11]=l=>(I.value=!0,b.value=!0,E()))},{default:r(()=>t[17]||(t[17]=[m(" Create User ")])),_:1})]),n(q,{items:o($),"search-query":o(k),selectable:"",headers:o(v),onSelectItems:y},{header:r(()=>t[18]||(t[18]=[u("div",{class:"text-gray-950 text-base font-medium"},"Users",-1)])),roleList:r(({item:l})=>[m(h(l.roleList.map(P=>P.title).toString()),1)]),edit:r(({item:l})=>[u("div",$e,[n(c,{color:"info",variant:"outline",onClick:P=>(I.value=!0,w(l))},{icon:r(()=>[n(A,{class:"icon-edit"})]),default:r(()=>[t[19]||(t[19]=m(" Edit "))]),_:2},1032,["onClick"]),n(c,{color:"danger",onClick:P=>(L.value=!0,_.value=l.id)},{default:r(()=>[n(A,{class:"icon-trash"})]),_:2},1032,["onClick"])])]),_:1},8,["items","search-query","headers"])]),_:1})}}});export{Pe as default};
