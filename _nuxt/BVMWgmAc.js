import{_ as S}from"./BGCo7yP8.js";import{_ as D}from"./xBkyOM2N.js";import{_ as E}from"./Dp47PizI.js";import{_ as G}from"./_MxDGbKs.js";import{_ as P}from"./CfMjetS_.js";import{g as j,u as N}from"./D5yC5vkR.js";import{P as K}from"./DWzojfZc.js";import{e as O,r as s,h as U,i as q,o as k,w as i,s as y,a as c,b as m,u as n,l as A,c as F,d as H}from"./Bt1u4B0-.js";import{u as M}from"./B4oWGeeH.js";import"./DnIpOOP4.js";const $={class:"flex lg:flex-row flex-col lg:justify-between justify-center items-center mb-5"},z={class:"flex lg:flex-row flex-col lg:justify-between items-center lg:gap-2 lg:mb-0 mb-2"},R={class:"flex flex-row gap-4"},ae=O({__name:"global-listing",setup(T){M({title:"Global Listing"});const l=s(""),b=s([]),u=s(null),v=s([{key:"sku",label:"SKU",sort:!0},{key:"productCost",label:"Cost (HKD)",sort:!0},{key:"name",label:"Item title",sort:!0},{key:"weight",label:"Weight (kg)",sort:!0}]),x=async()=>{try{const{data:t}=await j();b.value=(t==null?void 0:t.list)||[]}catch(t){y({title:"Error !",content:t},"danger")}},C=()=>{p.value=null,u.value&&u.value.click()},p=s(null),h=s(0),I=async t=>{try{const e=t.target.files.item(0),f=await(d=>new Promise((_,o)=>{K.parse(d,{encoding:"ISO-8859-1",download:!0,header:!0,skipEmptyLines:!0,complete:a=>{if(a.errors.length>0)o(a.errors);else{const V=a.data.map(B=>Object.fromEntries(Object.entries(B).map(([L,g])=>[L.trim(),typeof g=="string"?g.trim():g])));_(V)}},error:a=>o(a)})}))(e);p.value=f;const{data:r}=await N(p.value);r&&y({title:"Success !",content:r.message},"success")}catch(e){y({title:"Error !",content:e},"danger")}finally{h.value++,x()}};return U(async()=>{await x()}),(t,e)=>{const w=S,f=D,r=E,d=G,_=P;return k(),q(_,null,{default:i(()=>[c("div",$,[c("div",z,[m(w,{modelValue:n(l),"onUpdate:modelValue":e[0]||(e[0]=o=>A(l)?l.value=o:null),placeholder:"Search","icon-left":"icon-zoom"},null,8,["modelValue"])]),c("div",R,[m(r,{color:"primary",class:"relative",onClick:C},{icon:i(()=>[m(f,{class:"icon-cloud-upload"})]),default:i(()=>[e[2]||(e[2]=H(" Create Listing (CSV) "))]),_:1}),(k(),F("input",{type:"file",accept:".csv",ref_key:"fileInput",ref:u,onChange:e[1]||(e[1]=o=>I(o)),key:n(h),hidden:""},null,32))])]),m(d,{items:n(b),"search-query":n(l),headers:n(v)},{header:i(()=>e[3]||(e[3]=[c("div",{class:"text-gray-950 text-base font-medium"},"Global Listing",-1)])),_:1},8,["items","search-query","headers"])]),_:1})}}});export{ae as default};
